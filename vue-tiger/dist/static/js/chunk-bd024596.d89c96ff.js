(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-bd024596"],{"133c":function(e,t,a){"use strict";var r=a("7c25"),s=a.n(r);s.a},"31ff":function(e,t,a){"use strict";var r=a("4e45"),s=a.n(r);s.a},"4e45":function(e,t,a){},"7c25":function(e,t,a){},a15b:function(e,t,a){"use strict";var r=a("23e7"),s=a("44ad"),n=a("fc6a"),o=a("a640"),i=[].join,u=s!=Object,l=o("join",",");r({target:"Array",proto:!0,forced:u||!l},{join:function(e){return i.call(n(this),void 0===e?",":e)}})},ecac:function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"app-container"},[a("div",[a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:6,xs:24}},[a("user-card",{attrs:{user:e.user}})],1),a("el-col",{attrs:{span:18,xs:24}},[a("el-card",[a("el-tabs",{model:{value:e.activeTab,callback:function(t){e.activeTab=t},expression:"activeTab"}},[a("el-tab-pane",{attrs:{label:"修改密码",name:"ChangePassword"}},[a("changePassword")],1),a("el-tab-pane",{attrs:{label:"管理个人资料",name:"PersonalSettings"}},[a("PersonalSettings",{attrs:{user:e.user}})],1)],1)],1)],1)],1)],1)])},s=[],n=(a("a15b"),a("b0c0"),a("5530")),o=a("2f62"),i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-card",{staticStyle:{"margin-bottom":"20px"}},[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("span",[e._v("关于我")])]),a("div",{staticClass:"user-profile"},[a("div",{staticClass:"box-center"},[a("pan-thumb",{attrs:{image:e.getFilePathByName(e.user.avatar),height:"100px",width:"100px",hoverable:!1}},[a("div",[e._v("欢迎")]),e._v(" "+e._s(e.user.name)+" ")])],1),a("div"),a("div",{staticClass:"box-center"},[a("div",{staticClass:"user-name text-center"},[e._v(e._s(e.user.name))]),a("div",{staticClass:"user-role text-center text-muted"},[e._v(" "+e._s(e.user.role)+" ")])]),a("div",{staticClass:"box-center"},[a("el-upload",{attrs:{action:"",name:"file","before-upload":e.beforeUpload,"http-request":e.uploadAvatar,"show-file-list":!1}},[a("el-button",{attrs:{type:"primary",icon:"el-icon-upload"}},[e._v("修改头像")])],1)],1)]),a("div",{staticClass:"user-bio"},[a("div",{staticClass:"user-education user-bio-section"},[a("div",{staticClass:"user-bio-section-header"},[a("svg-icon",{attrs:{"icon-class":"education"}}),a("span",[e._v("个人介绍")])],1),a("div",{staticClass:"user-bio-section-body"},[a("div",{staticClass:"text-muted"},[e._v(" "+e._s(e.user.introduction?e.user.introduction:"个人介绍内容")+" ")])])])])])},u=[],l=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"pan-item",style:{zIndex:e.zIndex,height:e.height,width:e.width}},[a("div",{staticClass:"pan-info"},[a("div",{staticClass:"pan-info-roles-container"},[e._t("default")],2)]),a("div",{staticClass:"pan-thumb",style:{backgroundImage:"url("+e.image+")"}})])},c=[],m=(a("a9e3"),{name:"PanThumb",props:{image:{type:String,required:!0},zIndex:{type:Number,default:1},width:{type:String,default:"150px"},height:{type:String,default:"150px"}}}),d=m,p=(a("133c"),a("2877")),f=Object(p["a"])(d,l,c,!1,null,"799537af",null),h=f.exports,b=a("b775");function g(e){return Object(b["a"])({url:"/api/file-management/files/upload",method:"post",data:e})}var v=a("d6b0"),w={components:{PanThumb:h},props:{user:{type:Object,default:function(){return{name:"",userName:"",email:"",avatar:"",role:"admin",phoneNumber:"",introduction:""}}}},data:function(){return{loading:!1}},mounted:function(){},methods:{getFilePathByName:v["b"],beforeUpload:function(e){},uploadAvatar:function(e){var t=this,a=new FormData;a.append("file",e.file),g(a).then((function(e){t.user.avatar=e;var a={userName:t.user.userName,email:t.user.email,name:t.user.name,phoneNumber:t.user.phoneNumber,extraProperties:{Avatar:e,Introduction:t.user.introduction}};t.loading=!0,t.$store.dispatch("user/setUserInfo",a).then((function(e){t.loading=!1,t.$notify({title:"成功",message:"操作成功",type:"success",duration:2e3})}))}))}}},x=w,y=(a("31ff"),Object(p["a"])(x,i,u,!1,null,"992ec75a",null)),P=y.exports,N=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-form",{ref:"aForm",attrs:{model:e.aForm,rules:e.aRules}},[a("el-form-item",{attrs:{label:"原密码",prop:"password"}},[a("el-input",{attrs:{type:"password","show-password":""},model:{value:e.aForm.password,callback:function(t){e.$set(e.aForm,"password","string"===typeof t?t.trim():t)},expression:"aForm.password"}})],1),a("el-form-item",{attrs:{label:"新密码",prop:"newPassword"}},[a("el-input",{attrs:{type:"password","show-password":""},model:{value:e.aForm.newPassword,callback:function(t){e.$set(e.aForm,"newPassword","string"===typeof t?t.trim():t)},expression:"aForm.newPassword"}})],1),a("el-form-item",{attrs:{label:"确认新密码",prop:"againPassword"}},[a("el-input",{attrs:{type:"password","show-password":""},model:{value:e.aForm.againPassword,callback:function(t){e.$set(e.aForm,"againPassword","string"===typeof t?t.trim():t)},expression:"aForm.againPassword"}})],1),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:e.submit}},[e._v("提交")])],1)],1)},I=[],_=a("c24f"),C={data:function(){var e=this,t=function(t,a,r){""===a?r(new Error("确认密码不能为空")):a!==e.aForm.newPassword&&r(new Error("两次输入的密码不一致"))};return{aForm:{password:"",newPassword:"",againPassword:""},aRules:{password:[{required:!0,message:"原密码不能为空",trigger:["blur","change"]}],newPassword:[{required:!0,message:"新密码不能为空",trigger:["blur","change"]}],againPassword:[{required:!0,message:"确认密码不能为空",validator:t,trigger:["blur","change"]}]},loading:!1}},methods:{submit:function(){var e=this;this.$refs.aForm.validate((function(t){if(!t)return!1;e.loading=!0;var a={currentPassword:e.aForm.password,newPassword:e.aForm.againPassword};Object(_["a"])(a).then((function(t){e.loading=!1,e.$notify({title:"成功",message:"消息获取成功",type:"success",duration:2e3})})).catch((function(){e.loading=!1}))}))}}},F=C,$=Object(p["a"])(F,N,I,!1,null,null,null),j=$.exports,k=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-form",{ref:"aForm",attrs:{model:e.userInfo,rules:e.aRules}},[a("el-form-item",{attrs:{label:"姓名",prop:"name"}},[a("el-input",{model:{value:e.userInfo.name,callback:function(t){e.$set(e.userInfo,"name","string"===typeof t?t.trim():t)},expression:"userInfo.name"}})],1),a("el-form-item",{attrs:{label:"邮箱",prop:"email"}},[a("el-input",{model:{value:e.userInfo.email,callback:function(t){e.$set(e.userInfo,"email","string"===typeof t?t.trim():t)},expression:"userInfo.email"}})],1),a("el-form-item",{attrs:{label:"用户名",prop:"userName"}},[a("el-input",{model:{value:e.userInfo.userName,callback:function(t){e.$set(e.userInfo,"userName","string"===typeof t?t.trim():t)},expression:"userInfo.userName"}})],1),a("el-form-item",{attrs:{label:"手机号",prop:"phoneNumber"}},[a("el-input",{model:{value:e.userInfo.phoneNumber,callback:function(t){e.$set(e.userInfo,"phoneNumber","string"===typeof t?t.trim():t)},expression:"userInfo.phoneNumber"}})],1),a("el-form-item",{attrs:{label:"个人介绍"}},[a("el-input",{attrs:{type:"textarea",rows:2,placeholder:"请输入个人介绍"},model:{value:e.userInfo.extraProperties.Introduction,callback:function(t){e.$set(e.userInfo.extraProperties,"Introduction","string"===typeof t?t.trim():t)},expression:"userInfo.extraProperties.Introduction"}})],1),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:e.submit}},[e._v("提交")])],1)],1)},O=[],q={props:{user:{type:Object,default:function(){return{name:"",userName:"",email:"",avatar:"",role:"",phoneNumber:"",introduction:""}}}},data:function(){return{aRules:{name:[{required:!0,message:"字段不能为空",trigger:["blur","change"]}],email:[{required:!0,message:"邮箱不能为空",trigger:["blur","change"]}],userName:[{required:!0,message:"用户名不能为空",trigger:["blur","change"]}],phoneNumber:[{required:!0,message:"手机号不能为空",trigger:["blur","change"]}]},loading:!1,userInfo:{userName:this.user.userName,email:this.user.email,name:this.user.name,phoneNumber:this.user.phoneNumber,extraProperties:{Avatar:this.user.avatar,Introduction:this.user.introduction}}}},mounted:function(){console.log(this.user)},methods:{submit:function(){var e=this;this.$refs.aForm.validate((function(t){if(!t)return!1;e.loading=!0,e.$store.dispatch("user/setUserInfo",e.userInfo).then((function(t){e.loading=!1,e.$notify({title:"成功",message:"修改成功",type:"success",duration:2e3})})).catch((function(){}))}))}}},E=q,S=Object(p["a"])(E,k,O,!1,null,null,null),U=S.exports,T={name:"Profile",components:{UserCard:P,PersonalSettings:U,ChangePassword:j},data:function(){return{user:{},activeTab:"ChangePassword"}},computed:Object(n["a"])({},Object(o["b"])(["name","email","avatar","roles","userName","phoneNumber","introduction"])),created:function(){this.getUser()},methods:{getUser:function(){console.log(this),this.user={name:this.name,role:this.roles.join(" | "),email:this.email,avatar:this.avatar,userName:this.userName,phoneNumber:this.phoneNumber,introduction:this.introduction}}}},A=T,R=Object(p["a"])(A,r,s,!1,null,null,null);t["default"]=R.exports}}]);